dist: xenial

language: minimal

sudo: true

env:
  global:
    - PROJVERSION="6.1.1"
    - GDAL_VERSIONS="2.2.4 2.3.3 2.4.2 3.0.1 2.5.0rc1 trunk"
    - PROJBUILD=$HOME/projbuild
    - PROJINST=$HOME/projinstall
    - GDALINST=$HOME/gdalinstall
    - GDALBUILD=$HOME/gdalbuild
    - GHPAGESDIR=$HOME/ghpages
    
addons:
  apt:
    packages:
    - libhdf5-serial-dev
    - libatlas-dev
    - libatlas-base-dev
    - gfortran
    - libsqlite3-dev
    - sqlite3
    - checkinstall

before_install:
  - git clone --single-branch --branch gh-pages https://github.com/rbuffat/gdal_builder.git $GHPAGESDIR
  - rm -rf $GHPAGESDIR/.git
    
install:
#  - . ./scripts/build_proj.sh
  - . ./scripts/build_gdal.sh
  
deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
  keep_history: true
  local_dir: $HOME/ghpages
  on:
    branch: master
